<?xml version="1.0" encoding="UTF-8"?>

<odoo>
  <data>

    <record model='ir.ui.view' id = 'fleet_customer_list_view'>
      <field name= "name">fleet.customer.tree</field>
      <field name="model">fleet.customer</field>

      <field name="arch" type="xml">
        <tree>
          <field name="name"/>
          <field name="email"/>
          <field name="mobile"/>
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="fleet_customer_form_view">
      <field name="name">fleet.customer.form</field>
      <field name="model">fleet.customer</field>
      
      <field name="arch" type="xml">
        <form>
          <sheet>
            <group>
              <field name="name"/>
              <field name="email"/>
              <field name="mobile"/>
              <label for="street" string="Address"/>
              <div class="o_address_format">
                  <field name="street1" placeholder="Street..." class="o_address_street"/>
                  <field name="street2" placeholder="Street 2..." class="o_address_street"/>
                  <field name="city" placeholder="City" class="o_address_city"/>
                  <field name="state" class="o_address_state" placeholder="State" />
                  <field name="pincode" placeholder="ZIP" class="o_address_zip"/>
                  <field name="notes" placeholder="Country" class="o_address_country" />
              </div>
            </group>
          </sheet>
        </form>
      </field>
    </record>


    <record model="ir.ui.view" id="fleet_vehicle_contract_booking_list_view">
      <field name="name">fleet.vehicle.contract.booking.tree</field>
      <field name="model">fleet.vehicle.contract.booking</field>
      <field name="arch" type="xml">
        <tree string="contract list" decoration-info="state=='draft'" decoration-danger="state=='confirm'" decoration-success="state=='done'">
          <field name="customer"/>
          <field name="state"/>          
          <field name="start_date"/>
          <field name="end_date"/>
          <field name="duration"/>
          <field name="vehicle_id" context="{'start_date': start_date}"/>
          <field name="instruction"/>
        </tree>
      </field>
    </record>

    <record model = "ir.ui.view" id = "fleet_vehicle_contract_booking_form_view">
      <field name="name">fleet.vehicle.contract.booking.form</field>
      <field name="model">fleet.vehicle.contract.booking</field>

      <field name="arch" type="xml">
        <form>
          <header>
            <button string = "Draft" type="object" name="action_draft" states="confirm" class = "oe_highlight" />
            <button string = "Confirm" type="object" name="action_confirm" states="draft" class = "oe_highlight" />

             <button name="%(fleet_tracking.fleet_cancelled_contract_action)d" context="{'state':state}" string="Cancelled" type="action" class="oe_highlight" states="draft,confirm"/>
        
            <button string = "Running" type="object" name="action_running" states="confirm" class = "oe_highlight" />

            <button name="%(fleet_tracking.fleet_cancelled_contract_action)d" context="{'state':state}" string="Closed" type="action" class="oe_highlight" states="running"/>
            
            <button string = "ReNew" type="object" name="action_renew_contract" states="closed" class = "oe_highlight" />
            <field name="state" widget="statusbar" status_visible="draft,confirm,cancle,done"/>
          </header>

          <sheet>
            <div class="oe_button_box" name="button_box">
              <button name="open_trip"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-file-text">
                            <field name="count_trips" widget="statinfo" string="Trip"/>
              </button>
            </div>
            <group>
              <field name="customer"/>        
              <field name="start_date"/>
              <field name="end_date"/>
              <field name="duration"/>
              <field name="required_vehicle_ids" invisible="1"/>
              <field name="vehicle_id" widget="many2many_tags"/>
              <field name="cancelled_reason" readonly="1" attrs="{'invisible': [('cancelled_reason', '=', False)]}"/>
              <field name="cancelled_date" readonly="1" attrs="{'invisible': [('cancelled_date', '=', False)]}"/>
              <field name="closed_reason" readonly="1" attrs="{'invisible': [('closed_reason', '=', False)]}"/>
              <field name="closed_date" readonly="1" attrs="{'invisible': [('closed_date', '=', False)]}"/>
              <field name="instruction"/>
            </group>
          </sheet>
        </form>
      </field>
    </record>

<!--     <record id='fleet_vehicle_contract_booking_kanban_view' model='ir.ui.view'>
        <field name="name">fleet.vehicle.contract.booking.kanban</field>
        <field name="model">fleet.vehicle.contract.booking</field>
        <field name="arch" type="xml">
            <kanban default_group_by="vehicle_id">
                <field name="customer"/>        
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="duration"/>
                <field name="vehicle_id"/>
                <field name="instruction"/>
                <field name="model_id"/> -->
                <!--  <field name="activity_state"/>
                <progressbar field="activity_state" colors='{"planned": "success", "today": "warning", "overdue": "danger"}'/> -->

<!--                 <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_global_click">
                            <div class="oe_kanban_details">
                                <strong class="o_kanban_record_title">
                                   
                                </strong>
                                <ul>
                                    <li>
                                        <field name="vehicle_id"/>
                                    </li>
                                    <li>
                                        <field name="model_id"/>
                                    </li>
                                </ul>
                                <t t-name="Monthly Contract Graph">
                        <field name="kanban_dashboard_graph" t-att-graph_type="bar" widget="dashboard_graph"/>
                    </t>
                            </div>
                            
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record> 
 -->
      <record id='fleet_vehicle_contract_booking_kanban_view' model='ir.ui.view'>
        <field name="name">fleet.vehicle.contract.booking.kanban</field>
        <field name="model">fleet.vehicle.contract.booking</field>
        <field name="arch" type="xml">
            <kanban create="false" class="oe_background_grey o_kanban_dashboard o_account_kanban">
                <field name="customer"/>        
                <field name="start_date"/>
                <field name="end_date"/>
                <field name="duration"/>
                <field name="vehicle_id"/>
                <field name="instruction"/>
                <!-- <field name="model_id"/> -->

                <field name="kanban_dashboard_graph" invisible="1"/>
                <templates>
                    <t t-name="kanban-box">
                      <div>
                        <t t-set="dashboard" t-value-="record.kanban_dashboard_graph"/>
                        <t t-esc="dashboard"/>
                      </div>
                    </t>
            </templates>
            </kanban>
        </field>
    </record>

    <record model = "ir.ui.view" id = "fleet_vehicle_contract_booking_calendar_view">
      <field name="name">fleet.vehicle.contract.booking.calendar</field>
      <field name="model">fleet.vehicle.contract.booking</field>
      <field name="arch" type="xml">
        <calendar string="Contract's" date_start="start_date" date_stop="end_date" color="customer">
            <field name="customer"/>
        </calendar>
      </field>
    </record>


    <record model="ir.ui.view" id="fleet_vehicle_contract_booking_search_view">
      <field name="name">fleet.vehicle.contract.booking.search</field>
      <field name="model">fleet.vehicle.contract.booking</field>
      <field name="arch" type="xml">
          <search>
              <field name="customer"/>
              <field name="start_date"/>
              <field name="duration" string="Contract Type"
               filter_domain="[('duration', 'ilike', self)]"/>
<!-- 
              <group string="Group By">
                  <filter name="group_by_vehicle" string="Vehicle"
                          context="{'group_by': 'vehicle'}"/>
              </group> -->
          </search>
      </field>
    </record>


    <record model = "ir.ui.view" id = "fleet_vehicle_contract_booking_dashboard_view">
      <field name="name">fleet.vehicle.contract.booking.dashboard</field>
      <field name="model">fleet.vehicle.contract.booking</field>
      <field name="arch" type="xml">
        <dashboard>
            <view type="calendar" ref="fleet_tracking.fleet_vehicle_contract_booking_calendar_view"/>
            <!-- <view type="pivot" ref="sale_report.view_order_product_pivot"/> -->
        </dashboard>
      </field>
    </record>
<!--     <record model="ir.ui.view" id="fleet_vehicle_contract_graph_view">
      <field name="name">fleet.vehicle.contract.graph</field>
      <field name="model">fleet.vehicle.contract</field>
      <field name="arch" type="xml">
        <graph string="Trip of the vehicle">
          ''' waiting for data fetching session'''
        </graph>
      </field>
    </record> -->




    <record model="ir.actions.act_window" id = "fleet_vehicle_contract_booking_action_window">
      <field name="name"> Contract </field>
      <field name="res_model">fleet.vehicle.contract.booking</field>
      <field name="view_mode">tree,form,calendar,kanban,dashboard</field>
    </record>

    <record model="ir.ui.view" id="fleet_contract_renew_form_view">
      <field name="name">fleet.contract.renew.form</field>
      <field name="model">fleet.contract.renew</field>
      <field name="arch" type="xml">
        <form>
          <sheet>
            <group>
              <field name="contract_id"/>
              <field name="renew_date" readonly="1"/>
              <field name="required_vehicle_ids" invisible="1"/>
              <field name="start_date"/>
              <field name="end_date"/>
              <field name="duration"/>
              <field name="vehicle_id"/>
              <field name="instruction"/> 
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record model="ir.actions.act_window" id = "fleet_contract_renew_action_window">
      <field name="name"> Renew Contract </field>
      <field name="res_model">fleet.contract.renew</field>
      <field name="view_mode">form</field>
    </record> 


    <record model='ir.ui.view' id = 'fleet_vehicle_contract_trip_list_view'>
      <field name= "name">fleet.vehicle.contract.trip.tree</field>
      <field name="model">fleet.vehicle.contract.trip</field>
      <field name="arch" type="xml">
        <tree>
                  
          <field name="date"/>
          <field name="contract_id"/>
          <field name="driver_id"/>
          <field name="distance_travelled"/>
          <field name="no_of_person_in_trip"/>
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="fleet_vehicle_contract_trip_form_view">
      <field name="name">fleet.vehicle.contract.trip.form</field>
      <field name="model">fleet.vehicle.contract.trip</field>
      <field name="arch" type="xml">
        <form>

          <sheet>
            <group>
              <field name="date" readonly="1"/>
              <field name="contract_id"/>
              <field name="driver_id"/>
              <field name="distance_travelled"/>
              <field name="no_of_person_in_trip"/>
              <field name="address"/>
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record model="ir.actions.act_window" id = "fleet_vehicle_contract_trip_action_window">
      <field name="name"> Trip </field>
      <field name="res_model">fleet.vehicle.contract.trip</field>
      <field name="view_mode">tree,form</field>
    </record> 


    <record model="ir.ui.view" id="fleet_vehicle_contract_trip_address_form_view">
      <field name="name">fleet.vehicle.contract.trip.address.form</field>
      <field name="model">fleet.vehicle.contract.trip.address</field>
      <field name="arch" type="xml">
        <form>
          <sheet>
            <group>
              <label for="street" string="Address"/>
              <div class="o_address_format">
                  <field name="street1" placeholder="Street..." class="o_address_street"/>
                  <field name="street2" placeholder="Street 2..." class="o_address_street"/>
                  <field name="city" placeholder="City" class="o_address_city"/>
                  <field name="state" class="o_address_state" placeholder="State" />
                  <field name="pincode" placeholder="ZIP" class="o_address_zip"/>
                  <field name="notes" placeholder="Country" class="o_address_country" />
              </div>
            </group>
          </sheet>
        </form>
      </field>
    </record>

    <record model="ir.actions.act_window" id = "fleet_vehicle_contract_trip_address_action_window">
      <field name="name"> Address </field>
      <field name="res_model">fleet.vehicle.contract.trip.address</field>
      <field name="view_mode">form</field>
    </record> 

    <menuitem name="Contracts" id="fleet_vehicle_contract_booking_menu" parent="vehicle_brand_menu_root" sequence="3"/>

    <menuitem name="Contracts" id="fleet_vehicle_contract_booking_menu_child" parent="fleet_vehicle_contract_booking_menu" action="fleet_vehicle_contract_booking_action_window"/>

    <menuitem name="Trip" id="fleet_vehicle_contract_trip_menu_child" parent="fleet_vehicle_contract_booking_menu" action="fleet_vehicle_contract_trip_action_window"/>

  </data>
</odoo>



